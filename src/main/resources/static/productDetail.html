<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>상품 상세 보기</title>
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/productDetail.css" />
</head>
<body>
<div id="wrap">
    <div>
        <header id="header">
        </header>
    </div>
    <div class="container">
        <!-- 상품 정보가 동적으로 채워질 부분 -->
        <div id="product-details">
            <p>상품 정보를 불러오는 중...</p>
        </div>

        <div class="productsall">
            <div class="related-products">
                <h2>관련 상품</h2>
                <!-- 관련 상품 목록은 필요에 따라 비동기 처리 가능 -->
                <div class="product-item">
                    <img src="https://placehold.co/300x200/FF0000/FFFFFF?text=Related+Product+1" alt="관련 상품 1" />
                    <p>관련 상품 1</p>
                    <p>20,000 원</p>
                </div>
                <div class="product-item">
                    <img src="https://placehold.co/300x200/00FF00/000000?text=Related+Product+2" alt="관련 상품 2" />
                    <p>관련 상품 2</p>
                    <p>30,000 원</p>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    // DOMContentLoaded 이벤트는 HTML 문서의 모든 요소가 로드된 후에 실행됩니다.
    document.addEventListener('DOMContentLoaded', () => {
      // 현재 URL에서 상품 ID를 추출합니다.
      const urlParams = new URLSearchParams(window.location.search);
      const listingId = urlParams.get('id');

      if (listingId) {
        // 비동기 통신을 사용하여 백엔드 API에서 상품 정보를 가져옵니다.
        fetch(`/product/${listingId}`)
          .then(response => {
            if (!response.ok) {
              // HTTP 상태 코드가 200번대가 아닐 경우 에러 처리
              throw new Error('상품 정보를 불러오는데 실패했습니다.');
            }
            return response.json(); // 응답을 JSON 형식으로 변환
          })
          .then(product => {
            // 받아온 상품 정보를 HTML에 동적으로 삽입합니다.
            const productDetailsDiv = document.getElementById('product-details');
            productDetailsDiv.innerHTML = `
              <img src="${product.photoUrl}" alt="${product.title}" class="product-img" />
              <h1 class="product-name">상품명: ${product.title}</h1>
              <p class="product-nickname">판매자: ${product.sellerNickname}</p>
              <p class="product-price">가격: ${product.price.toLocaleString()} 원</p>
              <p class="product-introduct">${product.description}</p>
              <p class="introduct">상세정보</p>
              <hr />
            `;
          })
          .catch(error => {
            const productDetailsDiv = document.getElementById('product-details');
            productDetailsDiv.innerHTML = `<p style="color: red;">${error.message}</p>`;
            console.error('Error fetching product details:', error);
          });
      }
    });
</script>
<script src="js/header.js"></script>
</body>
</html>
