<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="amgn.amu.mapper.UserMapper">

    <resultMap id="UserMap" type="amgn.amu.domain.User">
        <id property="userId" column="USER_ID"/>
        <result property="id" column="ID"/>
        <result property="passwordHash" column="PASSWORD_HASH"/>
        <result property="userName" column="USER_NAME"/>
        <result property="email" column="EMAIL"/>
        <result property="userName" column="USER_NAME"/>
        <result property="nickName" column="NICK_NAME"/>
        <result property="gender" column="GENDER"/>
        <result property="phoneNumber" column="PHONE_NUMBER"/>
        <result property="birthYear" column="BIRTH_YEAR"/>
        <result property="birthMonth" column="BIRTH_MONTH"/>
        <result property="birthDay" column="BIRTH_DAY"/>
        <result property="province" column="PROVINCE"/>
        <result property="city" column="CITY"/>
        <result property="detailAddress" column="DETAIL_ADDRESS"/>
        <result property="status" column="STATUS"/>
        <result property="createdAt" column="CREATED_AT" jdbcType="TIMESTAMP" javaType="java.time.LocalDateTime"/>
        <result property="updatedAt" column="UPDATED_AT"/>
    </resultMap>

    <select id="existsById" resultType="boolean">
        SELECT CASE WHEN COUNT(*)>0 THEN 1 ELSE 0 END
        FROM USERS WHERE ID = #{id}
    </select>

    <select id="existsByEmail" resultType="boolean">
        SELECT CASE WHEN COUNT(*)>0 THEN 1 ELSE 0 END
        FROM USERS WHERE EMAIL = #{email}
    </select>

    <select id="existsByPhone" resultType="boolean">
        SELECT CASE WHEN COUNT(*)>0 THEN 1 ELSE 0 END
        FROM USERS WHERE PHONE_NUMBER = #{phoneNumber}
    </select>

    <select id="findById" resultMap="UserMap">
        SELECT * FROM USERS WHERE ID = #{id}
    </select>

    <insert id="insert" parameterType="amgn.amu.domain.User">
        INSERT INTO USERS (
        ID, PASSWORD_HASH, USER_NAME, EMAIL, NICK_NAME, GENDER, PHONE_NUMBER,
        BIRTH_YEAR, BIRTH_MONTH, BIRTH_DAY, PROVINCE, CITY, DETAIL_ADDRESS, STATUS, CREATED_AT, UPDATED_AT
        ) VALUES (
        #{id}, #{passwordHash}, #{userName},#{email}, #{nickName}, #{gender}, #{phoneNumber},
        #{birthYear}, #{birthMonth}, #{birthDay}, #{province}, #{city}, #{detailAddress},
        'ACTIVE', SYSTIMESTAMP, SYSTIMESTAMP
        )
    </insert>
</mapper>